<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>GNC</title>
    <link href="https://www.gnc.com/on/demandware.static/Sites-GNC-Site/-/default/dw230d3d57/images/favicon.ico" rel="shortcut icon" />

    <link rel="stylesheet" href="../../styles.css"/>

    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=1">

</head>
<body>

<div class="js_image_wrap"></div>


<script src="../../../reusable/cms-javascript-sdk.min.js"></script>
<script src="../../../reusable/handlebars.min.js"></script>
<script src="../../../reusable/utils.js"></script>
<script src="../../../reusable/service-utils.js"></script>
<script src="../../../reusable/handlebars_helpers.js"></script>

<script>
  function getQueryVar(params) {
    var paramsObj = {};
    var currentParam = null;

    for (var x = 0; x < params.length; x++) {
      currentParam = window.location.href.match(new RegExp(params[x] + "=([a-zA-Z0-9-\._]+)"));
      if (currentParam && currentParam.length > 1) {
        paramsObj[params[x]] = currentParam[1];
      }

      else {
        console.warn('Param: ' + x + ' not found');
      }
    }
    var url = 'https://' + paramsObj.vse + '/cms/content/query?fullBodyObject=true&scope=tree&store=any&query=%7B\"sys.iri\":\"http://content.cms.amplience.com/' + paramsObj.content + '"%7D&locale=' + paramsObj.locale + '&v=' + Date.now();
    console.debug("url: " + url);
    console.debug("vse: " + paramsObj.vse);
    console.debug("content: " + paramsObj.content);

    return paramsObj;
  }


  //AmpCa is global namespace generated by handlebars compiler
  AmpCa.utils = new AmpCa.Utils();
  var parsedParams = getQueryVar(['vse', 'content','locale']);

  AmpCa.utils.getHtmlServiceData({
    auth: {
      baseUrl: ('//' + parsedParams['vse']),
      id: parsedParams['content'],
      store: 'any',
      templateName: 'acc-template-image',
      locale: parsedParams['locale']
    },
    callback: function (data) {
      // console.debug(parsedParams);
      console.debug(data);
      document.querySelectorAll(".js_image_wrap")[0].innerHTML = data;
      // AmpCa.utils.postProcessing.execHtmlService('banner', {});
    }
  });

  AmpCa.utils.getDCData({
    url: AmpCa.utils.getQueryURL(['vse','content','locale']),
    callback: function (data) {
    },
    formatData: function (data) {
      return amp.inlineContent(JSON.parse(data));
    }
    });
</script>
</body>
</html>